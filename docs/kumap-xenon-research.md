# くまっぷ（Xenon）調査レポート

## 概要
- **サイト名**: くまっぷ - クマ目撃・痕跡情報を共有するマップアプリ
- **URL**: https://kumap-xenon.web.app/
- **運営**: 株式会社Xenon
- **対象地域**: 全国
- **データ公開**: ユーザー投稿 + 公式データ連携

## 重要な発見: 公式API提供！

### ✅ API仕様
- **OpenAPI仕様書**: https://kumap-xenon.web.app/openapi.yaml
- **認証方式**: Bearer Token（APIキー）
- **テナント制**: テナント登録が必要

### APIエンドポイント
1. **POST /api-points-list**: ポイント一覧の取得（スコープ: points:read）
2. **POST /api-points-create**: ポイントの作成（スコープ: points:write）
3. **POST /api-points-delete**: ポイントの削除（スコープ: points:delete）

### データ構造
- **種別**: クマ目撃、クマの痕跡、クマの被害（人身以外）、クマの人身被害
- **フィルター**: 都道府県、期間（年、年月、日付範囲）
- **位置情報**: 緯度経度、住所
- **追加データ**: 目撃時の状況、画像など

## 技術スタック
- **フロントエンド**: React + Leaflet.js
- **バックエンド**: Supabase Functions
- **地図タイル**: OpenStreetMap
- **認証**: APIキー（Bearer Token）

## スクレイピング可能性の評価

### ✅ 公式API利用（推奨）
1. **テナント申請**: https://kumap-xenon.web.app/ から申請
2. **APIキー発行**: テナント管理者がAPIキーを発行
3. **データ取得**: /api-points-list エンドポイントでデータ取得
4. **OpenAPI Generator**: 自動でクライアントコード生成可能

### 利点
- ✅ 公式にサポートされた方法
- ✅ 法的リスクなし
- ✅ データ形式が明確（OpenAPI仕様書）
- ✅ 自動クライアントコード生成
- ✅ 全国のデータを一元取得

### 制約
- ⚠️ テナント申請が必要（審査あり）
- ⚠️ APIキーの発行が必要
- ⚠️ CORS制限（サーバーサイドのみ）
- ⚠️ スコープによるアクセス制御

## 実装戦略

### 方法1: テナント申請してAPI利用（最推奨）
1. くまっぷにテナント申請
2. APIキーを発行
3. OpenAPI Generatorでクライアントコード生成
4. /api-points-list エンドポイントでデータ取得
5. 既存のbearSightingsテーブルにインポート

**推定難易度**: 低（公式APIなので簡単）

### 方法2: 公開データのスクレイピング（非推奨）
- くまっぷは公開マップを提供しているが、APIが公式に提供されているため、スクレイピングは不要
- 利用規約を確認する必要あり

## 次のステップ

1. ✅ くまっぷの利用規約を確認
2. ⏳ テナント申請（株式会社Xenonに問い合わせ）
3. ⏳ APIキー発行後、テストデータ取得
4. ⏳ OpenAPI Generatorでクライアントコード生成
5. ⏳ データインポートスクリプト実装

## 利用規約の確認

利用規約ページを確認する必要あり：
- https://kumap-xenon.web.app/ の「利用規約」リンク

## 結論

**くまっぷは公式APIを提供しており、テナント申請することで全国のクマ目撃情報を合法的に取得できる。**

これは最も推奨される方法であり、以下の理由から優先的に実装すべき：
1. ✅ 法的リスクなし（公式API）
2. ✅ 全国のデータを一元取得
3. ✅ データ形式が明確（OpenAPI仕様書）
4. ✅ 自動クライアントコード生成
5. ✅ 継続的なデータ更新が可能

**次のアクション**: テナント申請を行い、APIキーを取得する。


## 利用規約の重要ポイント

### ✅ サービスの目的（第1条）
- 熊による人身被害等を少なくすることを目的
- 地域の方々が危険エリアを把握し、安全な行動をとることができるよう支援
- 研究機関や行政と連携し、熊の行動パターンの分析や対策の立案に活用

### ⚠️ 禁止事項（第6条）
以下の行為が明示的に禁止されている：
1. **スクレイピング、クローリング、リバースエンジニアリング等の禁止**
2. 本サービスのサーバまたはネットワークに不正にアクセスする行為、または過度な負荷をかける行為
3. **本サービスを通じて得られた情報を、当社の事前の書面による許可なく、営利目的で他者に販売、転売、または再配布する行為**

### ✅ 投稿情報の利用許諾（第7条）
- ユーザーが投稿した情報の著作権はユーザーに留保
- ただし、ユーザーは当社に対し、投稿情報を本サービスの運営、プロモーション、**研究機関や行政との連携による熊対策などの目的で、無償かつ非独占的に利用することを許諾**

## 結論：API利用が必須

利用規約により、以下のことが明確になった：

### ❌ スクレイピングは禁止
- 第6条で「スクレイピング、クローリング」が明示的に禁止
- 「営利目的で他者に販売、転売、または再配布する行為」も禁止
- クマップは広告収入を得ているため、営利目的とみなされる可能性

### ✅ API利用は合法
- テナント申請してAPIキーを取得すれば、公式にデータ取得可能
- 「研究機関や行政との連携による熊対策などの目的」での利用は許諾されている
- クマップの目的（熊による人身被害を少なくする）と一致

### 次のアクション
1. ✅ テナント申請フォームから申請
2. ⏳ 株式会社Xenonからの承認待ち
3. ⏳ APIキー発行後、データ取得開始

**重要**: スクレイピングは利用規約違反のため、必ずテナント申請してAPI経由でデータを取得すること。
