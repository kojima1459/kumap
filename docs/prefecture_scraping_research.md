# 都道府県別詳細スクレイピング調査レポート

## 調査日時
2024年12月9日

## 調査目的
各都道府県の公式サイトから詳細なクマ出没情報（日時・場所・詳細）を自動収集するため、サイト構造とスクレイピング可能性を調査する。

---

## 1. クマ出没件数の多い都道府県（優先度順）

### 📊 2023年度～2025年度の統計データ

| 順位 | 都道府県 | 推定出没件数 | 備考 |
|------|----------|-------------|------|
| 1 | **岩手県** | 5,158件 | 全国の約28% |
| 2 | **秋田県** | 3,000件 | 全国の約16% |
| 3 | **長野県** | 高 | 東北以外で最多 |
| 4 | **新潟県** | 高 | 北陸地方で最多 |
| 5 | **北海道** | 中～高 | ヒグマの生息地 |
| 6 | **宮城県** | 中～高 | 東北地方 |
| 7 | **山形県** | 中～高 | 東北地方 |
| 8 | **福島県** | 中 | 東北地方 |
| 9 | **群馬県** | 中 | 関東地方 |
| 10 | **富山県** | 中 | 北陸地方 |

**データソース**:
- 環境省「クマの出没情報（速報値）」（2025年12月5日更新）
- 読売新聞「クマ被害はどこで？ 都道府県別の報告数」（2025年11月19日）
- tabi-mag「熊の生息数が多い県はどこ!?」（2024年8月20日）

**重要な発見**:
- 2023年度のツキノワグマ出没件数の**約6割が東北地方**
- 岩手県と秋田県の2県で**全国の4割**を占める
- 2025年4月～10月の出没件数は36,814件（前年度の約2倍）

---

## 2. 都道府県公式サイトの構造分類

### タイプA: 詳細な出没情報を公開（スクレイピング優先度: 高）

#### 1. **北海道ひぐまっぷ**
- URL: https://www.hiecc.or.jp/higuma_map/
- 形式: インタラクティブマップ（Google Maps API）
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 中（JavaScript生成、Playwright必須）
- 推定データ量: 中～高

#### 2. **群馬県（ArcGIS Dashboard）**
- URL: https://pref-gunma.maps.arcgis.com/apps/dashboards/5276d2ebf02a42da8595ed2a51a334c8
- 形式: ArcGIS Dashboard
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 高（ArcGIS API、認証不要）
- 推定データ量: 中

#### 3. **埼玉県（ArcGIS Dashboard）**
- URL: https://www.arcgis.com/apps/dashboards/6851a59c5a76496e9c9e3b54b2e67ff9
- 形式: ArcGIS Dashboard
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 高（ArcGIS API、認証不要）
- 推定データ量: 中

#### 4. **新潟県（ArcGIS Dashboard）**
- URL: https://www.arcgis.com/apps/dashboards/20b4d06fb3b34776959a4e69c7a8511a
- 形式: ArcGIS Dashboard
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 高（ArcGIS API、認証不要）
- 推定データ量: 高

#### 5. **京都府GIS**
- URL: https://www.pref.kyoto.jp/choujyu/kumanitsuite.html
- 形式: 京都府独自のGISシステム
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 中～高（要調査）
- 推定データ量: 中

#### 6. **鳥取県（Google My Maps）**
- URL: https://www.google.com/maps/d/viewer?mid=1_E0bAOGdgHB2ttDsLaDSWem6AJvNObM
- 形式: Google My Maps
- データ: 場所・マーカー情報
- スクレイピング難易度: 中（Google Maps API）
- 推定データ量: 中

#### 7. **静岡県（Google My Maps）**
- URL: https://www.google.com/maps/d/viewer?mid=1hwFI-xmiB1uYeEpfNetfP15CS9uxo08
- 形式: Google My Maps
- データ: 場所・マーカー情報
- スクレイピング難易度: 中（Google Maps API）
- 推定データ量: 中

### タイプB: PDF/Excel形式で公開（スクレイピング優先度: 中）

#### 8. **岩手県**
- URL: https://www.pref.iwate.jp/kurashikankyou/shizen/choujuu/1006237.html
- 形式: PDF/Excelファイル
- データ: 日時・場所・詳細
- スクレイピング難易度: 中（PDF解析、定期更新）
- 推定データ量: 非常に高（全国最多）

#### 9. **秋田県**
- URL: https://www.pref.akita.lg.jp/pages/archive/81645
- 形式: PDF/Excelファイル
- データ: 日時・場所・詳細
- スクレイピング難易度: 中（PDF解析、定期更新）
- 推定データ量: 非常に高（全国2位）

#### 10. **長野県**
- URL: https://www.pref.nagano.lg.jp/shinrin/sangyo/ringyo/choju/joho/kuma-map.html
- 形式: 「けものおと2」アプリ + PDFファイル
- データ: 日時・場所・詳細・座標
- スクレイピング難易度: 中（アプリAPI解析 or PDF解析）
- 推定データ量: 高
- **特徴**:
  - スマートフォンアプリ「けものおと2」で地図表示
  - ヒートマップ表示対応
  - ユーザー投稿機能
  - アラート通知機能
  - 月次PDFファイル公開（令和7年4月～11月）

### タイプC: 概要のみ公開（スクレイピング優先度: 低）

#### 11～36. その他の都道府県
- 形式: 静的HTMLページ、概要文のみ
- データ: 注意喚起、概要情報のみ
- スクレイピング難易度: 低（詳細データなし）
- 推定データ量: 低

---

## 3. スクレイピング実装の優先度

### 🔴 **優先度S（即座に実装すべき）**

1. **岩手県** - 全国最多の出没件数、PDF/Excel形式
2. **秋田県** - 全国2位の出没件数、PDF/Excel形式
3. **長野県** - 東北以外で最多、HTMLテーブル形式

**理由**: 出没件数が多く、データ形式が比較的単純（PDF/HTML）

### 🟠 **優先度A（早急に実装すべき）**

4. **北海道ひぐまっぷ** - ヒグマの生息地、Google Maps API
5. **新潟県** - 北陸地方で最多、ArcGIS Dashboard
6. **群馬県** - 関東地方、ArcGIS Dashboard
7. **埼玉県** - 関東地方、ArcGIS Dashboard

**理由**: 出没件数が多いが、スクレイピング難易度が高い（JavaScript生成）

### 🟡 **優先度B（余裕があれば実装）**

8. **京都府GIS** - 独自GISシステム、要調査
9. **鳥取県** - Google My Maps
10. **静岡県** - Google My Maps

**理由**: 出没件数は中程度、スクレイピング難易度は中

---

## 4. 技術的な課題と対策

### 課題1: ArcGIS Dashboardのスクレイピング
- **問題**: ArcGIS DashboardはJavaScriptで動的にデータを生成
- **対策**: Playwright MCPを使用してブラウザ自動化、ArcGIS REST APIを直接呼び出す

### 課題2: PDF/Excelファイルの解析
- **問題**: PDF/Excelファイルは定期的に更新され、フォーマットが統一されていない
- **対策**: `pdfplumber`や`openpyxl`を使用してファイルを解析、正規表現でデータを抽出

### 課題3: Google My Mapsのスクレイピング
- **問題**: Google My MapsはGoogle Maps APIで生成され、認証が必要な場合がある
- **対策**: Playwright MCPを使用してブラウザ自動化、KMLエクスポート機能を利用

### 課題4: データの正規化
- **問題**: 各都道府県でデータフォーマットが異なる（日時形式、住所表記、座標系）
- **対策**: 共通のデータスキーマを定義し、各都道府県ごとに正規化ロジックを実装

### 課題5: 重複データの排除
- **問題**: 同じ出没情報が複数のソースから収集される可能性
- **対策**: 日時・場所・詳細の類似度を計算し、重複を検出・排除

---

## 5. 次のステップ

### フェーズ2: Playwright MCPを使用した詳細スクレイピング実装
1. Playwright MCPのセットアップと動作確認
2. 優先度Sの3都道府県（岩手・秋田・長野）のスクレイピングロジック実装
3. データ正規化ロジックの実装
4. 重複データ排除ロジックの実装

### フェーズ3: 自動実行スケジュールの設定
1. 既存のYahoo!スクレイピングと統合
2. エラーハンドリングとリトライロジック実装
3. テスト実装と動作確認

---

## 参考資料

- 環境省「クマに関する各種情報・取組」: https://www.env.go.jp/nature/choju/effort/effort12/effort12.html
- 読売新聞「クマ被害はどこで？」: https://www.yomiuri.co.jp/topics/20251030-OYT8T50082/
- tabi-mag「熊の生息数が多い県」: https://tabi-mag.jp/bear-infestation/
