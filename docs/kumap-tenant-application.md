# くまっぷテナント申請ガイド

## 申請URL
https://kumap-xenon.web.app/application

---

## 申請フォーム記入例

### テナント情報

#### テナント名（必須）
```
クマップ（Kumap）
```

#### テナントID（必須）
```
kumap-bear-sighting
```
※小文字英数字とハイフンのみ使用可能

#### 利用目的（必須）
```
全国のクマ目撃情報を集約し、地域住民や観光客に安全情報を提供するためのWebアプリケーション「クマップ（Kumap）」を開発・運営しています。

本サービスは、Yahoo!ニュース、長野県公式PDF、その他の公式データソースから収集したクマ目撃情報を地図上に表示し、ユーザーが危険エリアを把握できるようにすることを目的としています。

くまっぷのAPIを利用することで、全国のクマ目撃情報を統合し、より包括的で正確な情報提供が可能になります。これにより、クマによる人身被害を減らし、地域の安全性向上に貢献したいと考えています。

具体的な利用方法：
1. くまっぷAPIから全国のクマ目撃情報を取得
2. 既存のデータソース（Yahoo!ニュース、長野県PDF等）と統合
3. 重複排除ロジックを適用してデータ品質を向上
4. 地図上に表示し、ユーザーに提供
5. 毎日自動更新して最新情報を維持

本サービスは非営利目的で運営され、広告収入や寄付により運営費を賄っています。くまっぷのデータは、熊対策という公共の利益のために活用されます。
```

#### 関連URL（任意）
```
https://kumamap.com
```
※現在のクマップのURL

---

### 申請者情報

#### 氏名（必須）
```
[ユーザーの氏名を入力]
```

#### メールアドレス（必須）
```
[ユーザーのメールアドレスを入力]
```
※承認後、このメールアドレスに招待メールが送信されます

---

## 申請後の流れ

1. **申請提出**: フォームを送信
2. **管理者審査**: 株式会社Xenonが審査（数日～1週間程度）
3. **承認通知**: 登録メールアドレスに招待メールが送信
4. **ログイン**: 招待メールのリンクからログイン
5. **APIキー発行**: テナント設定ページからAPIキーを発行
6. **API利用開始**: APIキーを使用してデータ取得開始

---

## テナント機能

### 現在利用可能な機能

1. **公式投稿マーク**
   - テナントとして投稿したポイントにチェックマークが付与
   - 公式情報として識別される

2. **複数人での管理**
   - テナントメンバー全員でポイントの作成・編集・削除が可能

3. **API連携**
   - テナントの投稿データをAPI経由で外部システムに提供
   - APIを使って自動的にポイントを作成
   - OpenAPI仕様からクライアントコード自動生成

### 今後予定されている機能

1. **データ分析・レポート機能**
   - 蓄積されたポイントデータを分析
   - 傾向やパターンを可視化

2. **エリア別通知機能**
   - 特定のエリアに投稿があった際に自動通知
   - 迅速な対応や情報共有が可能

---

## API仕様

### OpenAPI仕様書
https://kumap-xenon.web.app/openapi.yaml

### エンドポイント

#### 1. ポイント一覧の取得
- **エンドポイント**: POST /api-points-list
- **スコープ**: points:read
- **説明**: テナントのポイント一覧を取得

#### 2. ポイントの作成
- **エンドポイント**: POST /api-points-create
- **スコープ**: points:write
- **説明**: 新しいポイントを作成

#### 3. ポイントの削除
- **エンドポイント**: POST /api-points-delete
- **スコープ**: points:delete
- **説明**: 既存のポイントを削除

### 認証方法
```
Authorization: Bearer kumap_tk__YOUR_API_KEY_HERE
```

### クライアントコード生成
OpenAPI Generatorを使用して自動生成可能：
```bash
openapi-generator-cli generate -i https://kumap-xenon.web.app/openapi.yaml -g typescript-axios -o ./generated
```

---

## 利用規約の重要ポイント

### ✅ 許可される使用
- テナント申請・承認後のAPI利用
- 研究機関や行政との連携による熊対策などの目的での利用
- 非営利目的での情報共有

### ❌ 禁止事項
- スクレイピング、クローリング、リバースエンジニアリング
- 本サービスのサーバまたはネットワークに不正にアクセスする行為
- 本サービスを通じて得られた情報を、当社の事前の書面による許可なく、営利目的で他者に販売、転売、または再配布する行為

---

## 問い合わせ先

**株式会社Xenon**
- お問い合わせフォーム: https://kumap-xenon.web.app/ の「お問い合わせ」リンク
- 利用規約: https://kumap-xenon.web.app/terms

---

## 次のステップ

1. ✅ テナント申請フォームを提出
2. ⏳ 承認待ち（数日～1週間程度）
3. ⏳ APIキー発行
4. ⏳ くまっぷAPI統合実装
5. ⏳ テスト実装と動作確認
6. ⏳ 自動実行スケジュール設定（毎日午前3時）

---

## 実装予定の機能

### くまっぷAPI統合後の機能

1. **全国データの一括取得**
   - くまっぷAPIから全国のクマ目撃情報を取得
   - 既存のYahoo!ニュース、長野県PDFデータと統合

2. **重複排除ロジックの適用**
   - 都道府県 + 市町村 + 日付（時刻無視）
   - 緯度経度が近い（0.01度以内 = 約1km）+ 日付
   - sourceUrlが同じ（公式データ）

3. **自動更新スケジュール**
   - 毎日午前3時に自動実行
   - 新規データのみインポート
   - エラーハンドリングとログ記録

4. **データ品質向上**
   - 複数のデータソースを統合
   - 重複データの自動排除
   - 緯度経度の正確性向上

---

## 期待される効果

1. **データカバレッジの拡大**
   - 全国47都道府県のデータを網羅
   - 既存データ（長野県、Yahoo!ニュース）との統合

2. **データ品質の向上**
   - 公式データソースの追加
   - 重複排除による正確性向上

3. **メンテナンスの簡素化**
   - 公式APIによる安定したデータ取得
   - 法的リスクの回避

4. **ユーザー体験の向上**
   - より包括的な情報提供
   - リアルタイムに近い情報更新
